<!-- GameStatePanel Template - Rendered by presenter -->
<!-- Data: . is *BaseGameStatePanel with Game, State, PlayerStats, and computed fields -->
<div class="game-state-panel h-full bg-white dark:bg-gray-800 p-3 overflow-y-auto text-sm">
  <h4 class="font-medium text-gray-900 dark:text-white mb-3 text-xs uppercase tracking-wide">
    Players
  </h4>

  <!-- Players List -->
  {{ if and .Game .Game.Config .Game.Config.Players }}
  <div class="space-y-2 mb-4">
    {{ range .Game.Config.Players }}
    {{ $isCurrentPlayer := eq .PlayerId $.State.CurrentPlayer }}
    {{ $stats := index $.PlayerStats .PlayerId }}
    <div class="player-row rounded-lg p-2 {{ if $isCurrentPlayer }}bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-300 dark:border-yellow-700{{ else }}bg-gray-50 dark:bg-gray-700/50{{ end }}">
      <!-- Player Header Row -->
      <div class="flex items-center justify-between mb-1">
        <div class="flex items-center space-x-2">
          <!-- Player Color Indicator -->
          <div class="w-5 h-5 rounded flex items-center justify-center text-white text-xs font-bold player-color-{{ .PlayerId }}">
            {{ if eq .PlayerType "ai" }}A{{ else }}{{ .PlayerId }}{{ end }}
          </div>
          <!-- Player Name -->
          <span class="font-medium text-xs text-gray-900 dark:text-white">{{ .Name }}</span>
          <!-- Current Turn Indicator -->
          {{ if $isCurrentPlayer }}
          <span class="text-yellow-600 dark:text-yellow-400 text-xs">&#x25C0;</span>
          {{ end }}
        </div>
      </div>
      <!-- Player Stats Row -->
      <div class="flex items-center space-x-3 text-xs pl-7">
        <!-- Bases Count -->
        <div class="flex items-center" title="Bases owned">
          <span class="mr-0.5 player-text-{{ .PlayerId }}">&#x1F3E0;</span>
          <span class="text-gray-700 dark:text-gray-300">{{ if $stats }}{{ $stats.Bases }}{{ else }}0{{ end }}</span>
        </div>
        <!-- Units Count -->
        <div class="flex items-center" title="Units">
          <span class="mr-0.5 player-text-{{ .PlayerId }}">&#x1F464;</span>
          <span class="text-gray-700 dark:text-gray-300">{{ if $stats }}{{ $stats.Units }}{{ else }}0{{ end }}</span>
        </div>
        <!-- Coins -->
        <div class="flex items-center" title="Coins">
          <span class="text-yellow-500 mr-0.5">&#x26A1;</span>
          <span class="text-gray-700 dark:text-gray-300">{{ .Coins }}</span>
        </div>
      </div>
    </div>
    {{ end }}
  </div>
  {{ end }}

  <!-- Round/Turn Info -->
  <div class="pt-3 border-t border-gray-200 dark:border-gray-700">
    <div class="text-xs text-gray-600 dark:text-gray-400">
      {{ if .State }}<span class="font-semibold">Round {{ .State.TurnCounter }}</span>{{ end }}{{ if and .Game .Game.Config .Game.Config.Settings }}{{ if gt .Game.Config.Settings.MaxTurns 0 }}. Turn limit: <span class="font-semibold">{{ .Game.Config.Settings.MaxTurns }}</span>.{{ end }}{{ end }}
    </div>
  </div>

  <!-- Current Player Coins/Income Summary -->
  {{ if gt .CurrentPlayerIncome 0 }}
  <div class="mt-3 pt-3 border-t border-gray-200 dark:border-gray-700">
    <div class="flex items-center mb-1">
      <span class="text-yellow-500 mr-1">&#x1F4B0;</span>
      <span class="font-bold text-gray-900 dark:text-white">{{ .CurrentPlayerCoins }}</span>
    </div>
    <div class="text-xs text-gray-600 dark:text-gray-400">
      Income <span class="font-semibold text-green-600 dark:text-green-400">{{ .CurrentPlayerIncome }}</span>{{ if .IncomeBreakdown }} ({{ .IncomeBreakdown }}){{ end }}
    </div>
  </div>
  {{ end }}
</div>
