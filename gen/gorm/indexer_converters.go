// Code generated by protoc-gen-dal-gorm. DO NOT EDIT.
package gorm

import (
	"time"

	models "github.com/panyam/turnengine/games/weewar/gen/go/weewar/v1/models"

	"google.golang.org/protobuf/types/known/timestamppb"
)

// Helper functions for built-in type conversions

// timestampToInt64 converts a protobuf Timestamp to Unix seconds (int64).
// Returns 0 if timestamp is nil.
func timestampToInt64(ts *timestamppb.Timestamp) int64 {
	if ts == nil {
		return 0
	}
	return ts.AsTime().Unix()
}

// int64ToTimestamp converts Unix seconds (int64) to a protobuf Timestamp.
// Returns nil if the input is 0.
func int64ToTimestamp(seconds int64) *timestamppb.Timestamp {
	if seconds == 0 {
		return nil
	}
	return timestamppb.New(time.Unix(seconds, 0))
}

// EntityIndexStateToEntityIndexStateGORM converts a models.EntityIndexState to EntityIndexStateGORM.
// The optional decorator function allows custom field transformations.
func EntityIndexStateToEntityIndexStateGORM(
	src *models.EntityIndexState,
	dest *EntityIndexStateGORM,
	decorator func(*models.EntityIndexState, *EntityIndexStateGORM) error,
) (out *EntityIndexStateGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &EntityIndexStateGORM{}
	}

	// Initialize struct with inline values
	*dest = EntityIndexStateGORM{
		EntityType:      src.EntityType,
		EntityId:        src.EntityId,
		IndexType:       src.IndexType,
		Status:          src.Status,
		LastError:       src.LastError,
		LastContentHash: src.LastContentHash,
		RetryCount:      src.RetryCount,
		CurrentLroId:    src.CurrentLroId,
	}
	out = dest

	if src.LastQueuedAt != nil {
		out.LastQueuedAt = timestampToInt64(src.LastQueuedAt)
	}
	if src.LastIndexedAt != nil {
		out.LastIndexedAt = timestampToInt64(src.LastIndexedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// EntityIndexStateFromEntityIndexStateGORM converts a EntityIndexStateGORM back to models.EntityIndexState.
// The optional decorator function allows custom field transformations.
func EntityIndexStateFromEntityIndexStateGORM(
	dest *models.EntityIndexState,
	src *EntityIndexStateGORM,
	decorator func(dest *models.EntityIndexState, src *EntityIndexStateGORM) error,
) (out *models.EntityIndexState, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &models.EntityIndexState{}
	}

	// Initialize struct with inline values
	*dest = models.EntityIndexState{
		EntityType:      src.EntityType,
		EntityId:        src.EntityId,
		IndexType:       src.IndexType,
		LastQueuedAt:    int64ToTimestamp(src.LastQueuedAt),
		LastIndexedAt:   int64ToTimestamp(src.LastIndexedAt),
		Status:          src.Status,
		LastError:       src.LastError,
		LastContentHash: src.LastContentHash,
		RetryCount:      src.RetryCount,
		CurrentLroId:    src.CurrentLroId,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// IndexRecordsLROToIndexRecordsLROGORM converts a models.IndexRecordsLRO to IndexRecordsLROGORM.
// The optional decorator function allows custom field transformations.
func IndexRecordsLROToIndexRecordsLROGORM(
	src *models.IndexRecordsLRO,
	dest *IndexRecordsLROGORM,
	decorator func(*models.IndexRecordsLRO, *IndexRecordsLROGORM) error,
) (out *IndexRecordsLROGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &IndexRecordsLROGORM{}
	}

	// Initialize struct with inline values
	*dest = IndexRecordsLROGORM{
		LroId:       src.LroId,
		EntityType:  src.EntityType,
		CallbackUrl: src.CallbackUrl,
	}
	out = dest

	if src.CreatedAt != nil {
		out.CreatedAt = timestampToInt64(src.CreatedAt)
	}
	if src.UpdatedAt != nil {
		out.UpdatedAt = timestampToInt64(src.UpdatedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// IndexRecordsLROFromIndexRecordsLROGORM converts a IndexRecordsLROGORM back to models.IndexRecordsLRO.
// The optional decorator function allows custom field transformations.
func IndexRecordsLROFromIndexRecordsLROGORM(
	dest *models.IndexRecordsLRO,
	src *IndexRecordsLROGORM,
	decorator func(dest *models.IndexRecordsLRO, src *IndexRecordsLROGORM) error,
) (out *models.IndexRecordsLRO, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &models.IndexRecordsLRO{}
	}

	// Initialize struct with inline values
	*dest = models.IndexRecordsLRO{
		LroId:       src.LroId,
		EntityType:  src.EntityType,
		CreatedAt:   int64ToTimestamp(src.CreatedAt),
		UpdatedAt:   int64ToTimestamp(src.UpdatedAt),
		CallbackUrl: src.CallbackUrl,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}
